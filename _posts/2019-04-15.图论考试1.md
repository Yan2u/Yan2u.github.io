// 树状数组 区间更新 +　区间查询　
#include <bits/stdc++.h>
#define lowbit(x) (x & -x)
#define maxn 1000002
using namespace std;
typedef long long LL;
LL c1[maxn],c2[maxn];
LL n,m;
// c1[i]=sum{d[1]-d[i]}
// c2[i]=sum{kd[k],k=1-i}
void doupdate(LL x,LL _val) // 更新 c1 和 c2 加上 _val  
{
	for(int i=x;i<=n;i+=lowbit(i)){
		c1[i]+=_val;
		c2[i]+=x*_val;
	}
}
inline void doupdateSeg(LL L,LL R,LL _val)
{
	doupdate(L,_val);
	doupdate(R+1,-_val);
}
inline LL sumC(LL x)
{
	LL ans=0;
	for(int i=x;i>=1;i-=lowbit(i))
		ans+=(x+1)*c1[i]-c2[i];
	return ans;
}
int main()
{
	#ifndef ONLINE_JUDGE
	freopen("testin.txt","r",stdin);
	freopen("testout.txt","w",stdout);
	#endif
	cin>>n>>m;
	LL a=0,b=0,s=0;
	char op;
	for(int i=1;i<=n;i++){
		cin>>b;
		doupdate(i,b-a);
		a=b;
	}
	while(m--){
		cin>>op;
		if(op=='Q'){
			cin>>a>>b;
			cout<<sumC(b)-sumC(a-1)<<'\n';
		}
		else{
			cin>>a>>b>>s;
			doupdateSeg(a,b,s); 
		}
	}
	return 0;
}
